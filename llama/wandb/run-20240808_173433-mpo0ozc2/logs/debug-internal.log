2024-08-08 17:34:33,479 INFO    StreamThr :300062 [internal.py:wandb_internal():86] W&B internal server running at pid: 300062, started at: 2024-08-08 17:34:33.478812
2024-08-08 17:34:33,480 DEBUG   HandlerThread:300062 [handler.py:handle_request():146] handle_request: status
2024-08-08 17:34:33,480 INFO    WriterThread:300062 [datastore.py:open_for_write():85] open: /home/rwkv/JL/GMM/llama/wandb/run-20240808_173433-mpo0ozc2/run-mpo0ozc2.wandb
2024-08-08 17:34:33,481 DEBUG   SenderThread:300062 [sender.py:send():382] send: header
2024-08-08 17:34:33,510 DEBUG   SenderThread:300062 [sender.py:send():382] send: run
2024-08-08 17:34:33,760 INFO    SenderThread:300062 [dir_watcher.py:__init__():211] watching files in: /home/rwkv/JL/GMM/llama/wandb/run-20240808_173433-mpo0ozc2/files
2024-08-08 17:34:33,760 INFO    SenderThread:300062 [sender.py:_start_run_threads():1136] run started: mpo0ozc2 with start time 1723109673.478671
2024-08-08 17:34:33,767 DEBUG   HandlerThread:300062 [handler.py:handle_request():146] handle_request: check_version
2024-08-08 17:34:33,767 DEBUG   SenderThread:300062 [sender.py:send_request():409] send_request: check_version
2024-08-08 17:34:33,873 DEBUG   HandlerThread:300062 [handler.py:handle_request():146] handle_request: run_start
2024-08-08 17:34:33,882 DEBUG   HandlerThread:300062 [system_info.py:__init__():32] System info init
2024-08-08 17:34:33,882 DEBUG   HandlerThread:300062 [system_info.py:__init__():47] System info init done
2024-08-08 17:34:33,882 INFO    HandlerThread:300062 [system_monitor.py:start():194] Starting system monitor
2024-08-08 17:34:33,882 INFO    SystemMonitor:300062 [system_monitor.py:_start():158] Starting system asset monitoring threads
2024-08-08 17:34:33,882 INFO    HandlerThread:300062 [system_monitor.py:probe():214] Collecting system info
2024-08-08 17:34:33,882 INFO    SystemMonitor:300062 [interfaces.py:start():190] Started cpu monitoring
2024-08-08 17:34:33,883 INFO    SystemMonitor:300062 [interfaces.py:start():190] Started disk monitoring
2024-08-08 17:34:33,883 INFO    SystemMonitor:300062 [interfaces.py:start():190] Started gpu monitoring
2024-08-08 17:34:33,884 INFO    SystemMonitor:300062 [interfaces.py:start():190] Started memory monitoring
2024-08-08 17:34:33,884 INFO    SystemMonitor:300062 [interfaces.py:start():190] Started network monitoring
2024-08-08 17:34:33,890 DEBUG   HandlerThread:300062 [system_info.py:probe():196] Probing system
2024-08-08 17:34:33,891 DEBUG   HandlerThread:300062 [system_info.py:_probe_git():181] Probing git
2024-08-08 17:34:33,894 DEBUG   HandlerThread:300062 [system_info.py:_probe_git():189] Probing git done
2024-08-08 17:34:33,894 DEBUG   HandlerThread:300062 [system_info.py:probe():244] Probing system done
2024-08-08 17:34:33,894 DEBUG   HandlerThread:300062 [system_monitor.py:probe():223] {'os': 'Linux-6.5.0-44-generic-x86_64-with-glibc2.35', 'python': '3.10.13', 'heartbeatAt': '2024-08-08T09:34:33.890120', 'startedAt': '2024-08-08T09:34:33.474264', 'docker': None, 'cuda': None, 'args': ('--local_rank=0', '--deepspeed', 'configs/ds_config_zero2_no_offload.json', '--model_name_or_path', '/home/rwkv/JL/model/llama2-7b', '--use_lora', 'True', '--init_lora_weights', 'pissa_niter_4', '--target_modules', 'q_proj,v_proj,k_proj,o_proj,gate_proj,down_proj,up_proj', '--lora_rank', '32', '--lora_alpha', '32', '--lora_dropout', '0', '--data_path', '/home/rwkv/JL/model/MetaMathQA', '--dataset_field', 'query', 'response', '--dataset_split', 'train[:100000]', '--output_dir', '/home/rwkv/JL/out_model/llama-test', '--num_train_epochs', '1', '--model_max_length', '512', '--per_device_train_batch_size', '1', '--gradient_accumulation_steps', '32', '--save_strategy', 'steps', '--save_steps', '1000', '--save_total_limit', '2', '--learning_rate', '2e-5', '--weight_decay', '0.', '--warmup_ratio', '0.', '--logging_steps', '1', '--lr_scheduler_type', 'cosine', '--report_to', 'wandb', '--merge', 'True'), 'state': 'running', 'program': '/home/rwkv/JL/GMM/llama/gmm.py', 'codePathLocal': 'gmm.py', 'codePath': 'llama/gmm.py', 'git': {'remote': 'https://github.com/JL-er/GMM.git', 'commit': '74dce7f004b5b16bfd24c8ca22e737aee6ff0769'}, 'email': '997529190@qq.com', 'root': '/home/rwkv/JL/GMM', 'host': 'rwkv-Z790M-AORUS-ELITE-AX', 'username': 'rwkv', 'executable': '/home/rwkv/miniconda3/bin/python', 'cpu_count': 20, 'cpu_count_logical': 28, 'cpu_freq': {'current': 2127.821392857143, 'min': 800.0, 'max': 5000.0}, 'cpu_freq_per_core': [{'current': 1783.954, 'min': 800.0, 'max': 5500.0}, {'current': 1184.672, 'min': 800.0, 'max': 5500.0}, {'current': 800.0, 'min': 800.0, 'max': 5500.0}, {'current': 4529.639, 'min': 800.0, 'max': 5500.0}, {'current': 5137.723, 'min': 800.0, 'max': 5500.0}, {'current': 800.0, 'min': 800.0, 'max': 5500.0}, {'current': 1257.618, 'min': 800.0, 'max': 5500.0}, {'current': 5311.952, 'min': 800.0, 'max': 5500.0}, {'current': 5390.16, 'min': 800.0, 'max': 5600.0}, {'current': 800.0, 'min': 800.0, 'max': 5600.0}, {'current': 3741.098, 'min': 800.0, 'max': 5600.0}, {'current': 5494.121, 'min': 800.0, 'max': 5600.0}, {'current': 4739.664, 'min': 800.0, 'max': 5500.0}, {'current': 3638.499, 'min': 800.0, 'max': 5500.0}, {'current': 5349.445, 'min': 800.0, 'max': 5500.0}, {'current': 1453.532, 'min': 800.0, 'max': 5500.0}, {'current': 3049.647, 'min': 800.0, 'max': 4300.0}, {'current': 800.0, 'min': 800.0, 'max': 4300.0}, {'current': 800.0, 'min': 800.0, 'max': 4300.0}, {'current': 800.0, 'min': 800.0, 'max': 4300.0}, {'current': 800.0, 'min': 800.0, 'max': 4300.0}, {'current': 800.0, 'min': 800.0, 'max': 4300.0}, {'current': 800.0, 'min': 800.0, 'max': 4300.0}, {'current': 800.0, 'min': 800.0, 'max': 4300.0}, {'current': 800.0, 'min': 800.0, 'max': 4300.0}, {'current': 800.0, 'min': 800.0, 'max': 4300.0}, {'current': 800.0, 'min': 800.0, 'max': 4300.0}, {'current': 800.0, 'min': 800.0, 'max': 4300.0}], 'disk': {'/': {'total': 916.2753829956055, 'used': 481.0260124206543}}, 'gpu': 'NVIDIA GeForce RTX 4090', 'gpu_count': 1, 'gpu_devices': [{'name': 'NVIDIA GeForce RTX 4090', 'memory_total': 25757220864}], 'memory': {'total': 62.55397415161133}}
2024-08-08 17:34:33,894 INFO    HandlerThread:300062 [system_monitor.py:probe():224] Finished collecting system info
2024-08-08 17:34:33,894 INFO    HandlerThread:300062 [system_monitor.py:probe():227] Publishing system info
2024-08-08 17:34:33,894 DEBUG   HandlerThread:300062 [system_info.py:_save_pip():52] Saving list of pip packages installed into the current environment
2024-08-08 17:34:33,895 DEBUG   HandlerThread:300062 [system_info.py:_save_pip():68] Saving pip packages done
2024-08-08 17:34:33,895 DEBUG   HandlerThread:300062 [system_info.py:_save_conda():75] Saving list of conda packages installed into the current environment
2024-08-08 17:34:34,761 INFO    Thread-12 :300062 [dir_watcher.py:_on_file_created():271] file/dir created: /home/rwkv/JL/GMM/llama/wandb/run-20240808_173433-mpo0ozc2/files/requirements.txt
2024-08-08 17:34:34,761 INFO    Thread-12 :300062 [dir_watcher.py:_on_file_created():271] file/dir created: /home/rwkv/JL/GMM/llama/wandb/run-20240808_173433-mpo0ozc2/files/conda-environment.yaml
2024-08-08 17:34:35,567 DEBUG   HandlerThread:300062 [system_info.py:_save_conda():87] Saving conda packages done
2024-08-08 17:34:35,567 DEBUG   HandlerThread:300062 [system_info.py:_save_code():90] Saving code
2024-08-08 17:34:35,569 DEBUG   HandlerThread:300062 [system_info.py:_save_code():111] Saving code done
2024-08-08 17:34:35,569 DEBUG   HandlerThread:300062 [system_info.py:_save_patches():128] Saving git patches
2024-08-08 17:34:35,606 DEBUG   HandlerThread:300062 [system_info.py:_save_patches():170] Saving git patches done
2024-08-08 17:34:35,606 INFO    HandlerThread:300062 [system_monitor.py:probe():229] Finished publishing system info
2024-08-08 17:34:35,607 DEBUG   SenderThread:300062 [sender.py:send():382] send: files
2024-08-08 17:34:35,607 INFO    SenderThread:300062 [sender.py:_save_file():1392] saving file wandb-metadata.json with policy now
2024-08-08 17:34:35,607 INFO    SenderThread:300062 [sender.py:_save_file():1392] saving file code/llama/gmm.py with policy now
2024-08-08 17:34:35,607 INFO    SenderThread:300062 [sender.py:_save_file():1392] saving file diff.patch with policy now
2024-08-08 17:34:35,611 DEBUG   HandlerThread:300062 [handler.py:handle_request():146] handle_request: stop_status
2024-08-08 17:34:35,613 DEBUG   SenderThread:300062 [sender.py:send_request():409] send_request: stop_status
2024-08-08 17:34:35,614 DEBUG   HandlerThread:300062 [handler.py:handle_request():146] handle_request: internal_messages
2024-08-08 17:34:35,760 INFO    Thread-12 :300062 [dir_watcher.py:_on_file_modified():288] file/dir modified: /home/rwkv/JL/GMM/llama/wandb/run-20240808_173433-mpo0ozc2/files/conda-environment.yaml
2024-08-08 17:34:35,760 INFO    Thread-12 :300062 [dir_watcher.py:_on_file_created():271] file/dir created: /home/rwkv/JL/GMM/llama/wandb/run-20240808_173433-mpo0ozc2/files/diff.patch
2024-08-08 17:34:35,760 INFO    Thread-12 :300062 [dir_watcher.py:_on_file_created():271] file/dir created: /home/rwkv/JL/GMM/llama/wandb/run-20240808_173433-mpo0ozc2/files/wandb-metadata.json
2024-08-08 17:34:35,760 INFO    Thread-12 :300062 [dir_watcher.py:_on_file_created():271] file/dir created: /home/rwkv/JL/GMM/llama/wandb/run-20240808_173433-mpo0ozc2/files/code/llama/gmm.py
2024-08-08 17:34:35,761 INFO    Thread-12 :300062 [dir_watcher.py:_on_file_created():271] file/dir created: /home/rwkv/JL/GMM/llama/wandb/run-20240808_173433-mpo0ozc2/files/code
2024-08-08 17:34:35,761 INFO    Thread-12 :300062 [dir_watcher.py:_on_file_created():271] file/dir created: /home/rwkv/JL/GMM/llama/wandb/run-20240808_173433-mpo0ozc2/files/code/llama
2024-08-08 17:34:35,796 DEBUG   SenderThread:300062 [sender.py:send():382] send: telemetry
2024-08-08 17:34:35,796 DEBUG   SenderThread:300062 [sender.py:send():382] send: config
2024-08-08 17:34:35,797 DEBUG   SenderThread:300062 [sender.py:send():382] send: metric
2024-08-08 17:34:35,797 DEBUG   SenderThread:300062 [sender.py:send():382] send: telemetry
2024-08-08 17:34:35,797 DEBUG   SenderThread:300062 [sender.py:send():382] send: metric
2024-08-08 17:34:35,797 WARNING SenderThread:300062 [sender.py:send_metric():1343] Seen metric with glob (shouldn't happen)
2024-08-08 17:34:35,797 DEBUG   SenderThread:300062 [sender.py:send():382] send: telemetry
2024-08-08 17:34:35,797 DEBUG   SenderThread:300062 [sender.py:send():382] send: telemetry
2024-08-08 17:34:35,797 DEBUG   SenderThread:300062 [sender.py:send():382] send: config
2024-08-08 17:34:35,894 ERROR   wandb-upload_0:300062 [internal_api.py:upload_file():2761] upload_file exception http://dian.sea-group.org:9098/local-files/mobius/huggingface/mpo0ozc2/wandb-metadata.json?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=FS%2BimP8205gHBuibMeAr0A%3D%3D%2F20240808%2Fwandb-local%2Fs3%2Faws4_request&X-Amz-Date=20240808T093435Z&X-Amz-Expires=86400&X-Amz-SignedHeaders=host&X-User=mobius&X-Amz-Signature=6fce44d20581613dc10a7fd12248a335474161ddb04b2c78494df672ae8ce046: 503 Server Error: Service Unavailable for url: http://dian.sea-group.org:9098/local-files/mobius/huggingface/mpo0ozc2/wandb-metadata.json?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=FS%2BimP8205gHBuibMeAr0A%3D%3D%2F20240808%2Fwandb-local%2Fs3%2Faws4_request&X-Amz-Date=20240808T093435Z&X-Amz-Expires=86400&X-Amz-SignedHeaders=host&X-User=mobius&X-Amz-Signature=6fce44d20581613dc10a7fd12248a335474161ddb04b2c78494df672ae8ce046
2024-08-08 17:34:35,894 ERROR   wandb-upload_0:300062 [internal_api.py:upload_file():2763] upload_file request headers: {'User-Agent': 'python-requests/2.31.0', 'Accept-Encoding': 'gzip, deflate, br, zstd', 'Accept': '*/*', 'Connection': 'keep-alive', 'Content-Length': '5525', 'Authorization': 'Basic dXNlcjpsb2NhbC0yNWIwMmYyNWUzNGUzOTlkYmI1OWJjNjFlZWVmY2RkZTYzNDRhOGI2'}
2024-08-08 17:34:35,894 ERROR   wandb-upload_0:300062 [internal_api.py:upload_file():2765] upload_file response body: b'<?xml version="1.0" encoding="UTF-8"?>\n<Error><Code>SlowDown</Code><Message>Resource requested is unreadable, please reduce your request rate</Message><Key>mobius/huggingface/mpo0ozc2/wandb-metadata.json</Key><BucketName>local-files</BucketName><Resource>/local-files/mobius/huggingface/mpo0ozc2/wandb-metadata.json</Resource><Region>wandb-local</Region><RequestId>17E9B71EEAC18AF3</RequestId><HostId>18bf63b7-01d2-4a3f-8eda-6b508ac9c4f3</HostId></Error>'
2024-08-08 17:34:35,930 ERROR   wandb-upload_1:300062 [internal_api.py:upload_file():2761] upload_file exception http://dian.sea-group.org:9098/local-files/mobius/huggingface/mpo0ozc2/code/llama/gmm.py?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=FS%2BimP8205gHBuibMeAr0A%3D%3D%2F20240808%2Fwandb-local%2Fs3%2Faws4_request&X-Amz-Date=20240808T093435Z&X-Amz-Expires=86400&X-Amz-SignedHeaders=host&X-User=mobius&X-Amz-Signature=481b3a9447c0151940ab910e58dac367e956d12bcc6972d9c6986c7111aa3bb0: 503 Server Error: Service Unavailable for url: http://dian.sea-group.org:9098/local-files/mobius/huggingface/mpo0ozc2/code/llama/gmm.py?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=FS%2BimP8205gHBuibMeAr0A%3D%3D%2F20240808%2Fwandb-local%2Fs3%2Faws4_request&X-Amz-Date=20240808T093435Z&X-Amz-Expires=86400&X-Amz-SignedHeaders=host&X-User=mobius&X-Amz-Signature=481b3a9447c0151940ab910e58dac367e956d12bcc6972d9c6986c7111aa3bb0
2024-08-08 17:34:35,930 ERROR   wandb-upload_1:300062 [internal_api.py:upload_file():2763] upload_file request headers: {'User-Agent': 'python-requests/2.31.0', 'Accept-Encoding': 'gzip, deflate, br, zstd', 'Accept': '*/*', 'Connection': 'keep-alive', 'Content-Length': '14197', 'Authorization': 'Basic dXNlcjpsb2NhbC0yNWIwMmYyNWUzNGUzOTlkYmI1OWJjNjFlZWVmY2RkZTYzNDRhOGI2'}
2024-08-08 17:34:35,930 ERROR   wandb-upload_1:300062 [internal_api.py:upload_file():2765] upload_file response body: b'<?xml version="1.0" encoding="UTF-8"?>\n<Error><Code>SlowDown</Code><Message>Resource requested is unreadable, please reduce your request rate</Message><Key>mobius/huggingface/mpo0ozc2/code/llama/gmm.py</Key><BucketName>local-files</BucketName><Resource>/local-files/mobius/huggingface/mpo0ozc2/code/llama/gmm.py</Resource><Region>wandb-local</Region><RequestId>17E9B71EE93026DE</RequestId><HostId>18bf63b7-01d2-4a3f-8eda-6b508ac9c4f3</HostId></Error>'
2024-08-08 17:34:36,116 ERROR   wandb-upload_2:300062 [internal_api.py:upload_file():2761] upload_file exception http://dian.sea-group.org:9098/local-files/mobius/huggingface/mpo0ozc2/diff.patch?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=FS%2BimP8205gHBuibMeAr0A%3D%3D%2F20240808%2Fwandb-local%2Fs3%2Faws4_request&X-Amz-Date=20240808T093435Z&X-Amz-Expires=86400&X-Amz-SignedHeaders=host&X-User=mobius&X-Amz-Signature=f962b4e45b99c522746c754bb12859894be48eba2fa14536fb9ae9546cf54c5a: 503 Server Error: Service Unavailable for url: http://dian.sea-group.org:9098/local-files/mobius/huggingface/mpo0ozc2/diff.patch?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=FS%2BimP8205gHBuibMeAr0A%3D%3D%2F20240808%2Fwandb-local%2Fs3%2Faws4_request&X-Amz-Date=20240808T093435Z&X-Amz-Expires=86400&X-Amz-SignedHeaders=host&X-User=mobius&X-Amz-Signature=f962b4e45b99c522746c754bb12859894be48eba2fa14536fb9ae9546cf54c5a
2024-08-08 17:34:36,116 ERROR   wandb-upload_2:300062 [internal_api.py:upload_file():2763] upload_file request headers: {'User-Agent': 'python-requests/2.31.0', 'Accept-Encoding': 'gzip, deflate, br, zstd', 'Accept': '*/*', 'Connection': 'keep-alive', 'Content-Length': '292165', 'Authorization': 'Basic dXNlcjpsb2NhbC0yNWIwMmYyNWUzNGUzOTlkYmI1OWJjNjFlZWVmY2RkZTYzNDRhOGI2'}
2024-08-08 17:34:36,116 ERROR   wandb-upload_2:300062 [internal_api.py:upload_file():2765] upload_file response body: b'<?xml version="1.0" encoding="UTF-8"?>\n<Error><Code>SlowDown</Code><Message>Resource requested is unreadable, please reduce your request rate</Message><Key>mobius/huggingface/mpo0ozc2/diff.patch</Key><BucketName>local-files</BucketName><Resource>/local-files/mobius/huggingface/mpo0ozc2/diff.patch</Resource><Region>wandb-local</Region><RequestId>17E9B71EEBE7428E</RequestId><HostId>18bf63b7-01d2-4a3f-8eda-6b508ac9c4f3</HostId></Error>'
2024-08-08 17:34:36,761 INFO    Thread-12 :300062 [dir_watcher.py:_on_file_created():271] file/dir created: /home/rwkv/JL/GMM/llama/wandb/run-20240808_173433-mpo0ozc2/files/output.log
